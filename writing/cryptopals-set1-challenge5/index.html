<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR | Julie Qiu</title>
<meta name=keywords content>
<meta name=description content="An explanation of how to implement repeating-key XOR.">
<meta name=author content="Me">
<link rel=canonical href=https://julieqiu.dev/writing/cryptopals-set1-challenge5/>
<meta name=google-site-verification content="XYZabc">
<meta name=yandex-verification content="XYZabc">
<meta name=msvalidate.01 content="XYZabc">
<link crossorigin=anonymous href=/writing/assets/css/stylesheet.min.cf053b6aad2c46b5d5a90acd6c3f258ae55f02ac6c02e394b53e5cf867c70319.css integrity="sha256-zwU7aq0sRrXVqQrNbD8liuVfAqxsAuOUtT5c+GfHAxk=" rel="preload stylesheet" as=style>
<link rel=preload href=/apple-touch-icon.png as=image>
<script defer crossorigin=anonymous src=/writing/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://julieqiu.dev/writing/%3Clink%20/%20abs%20url%3E>
<link rel=icon type=image/png sizes=16x16 href=https://julieqiu.dev/writing/%3Clink%20/%20abs%20url%3E>
<link rel=icon type=image/png sizes=32x32 href=https://julieqiu.dev/writing/%3Clink%20/%20abs%20url%3E>
<link rel=apple-touch-icon href=https://julieqiu.dev/writing/%3Clink%20/%20abs%20url%3E>
<link rel=mask-icon href=https://julieqiu.dev/writing/%3Clink%20/%20abs%20url%3E>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.92.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script><meta property="og:title" content="Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR">
<meta property="og:description" content="An explanation of how to implement repeating-key XOR.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://julieqiu.dev/writing/cryptopals-set1-challenge5/"><meta property="og:image" content="https://julieqiu.dev/writing/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content>
<meta property="article:published_time" content="2022-02-24T00:00:00+00:00">
<meta property="article:modified_time" content="2022-02-24T00:00:00+00:00"><meta property="og:site_name" content="ExampleSite">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://julieqiu.dev/writing/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name=twitter:title content="Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR">
<meta name=twitter:description content="An explanation of how to implement repeating-key XOR.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR","item":"https://julieqiu.dev/writing/cryptopals-set1-challenge5/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR","name":"Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR","description":"An explanation of how to implement repeating-key XOR.","keywords":[],"articleBody":"Implement repeating-key XOR From https://cryptopals.com/sets/1/challenges/5:\n Here is the opening stanza of an important work of the English language:\nBurning ‚Äòem, if you ain‚Äôt quick and nimble I go crazy when I hear a cymbal Encrypt it, under the key ‚ÄúICE‚Äù, using repeating-key XOR.\nIn repeating-key XOR, you‚Äôll sequentially apply each byte of the key; the first byte of plaintext will be XOR‚Äôd against I, the next C, the next E, then I again for the 4th byte, and so on.\nIt should come out to:\n0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f\nEncrypt a bunch of stuff using your repeating-key XOR function. Encrypt your mail. Encrypt your password file. Your .sig file. Get a feel for it. I promise, we aren‚Äôt wasting your time with this.\n Repeating-key XOR A description of how to perform repeating XOR is provided in the description:\n In repeating-key XOR, you‚Äôll sequentially apply each byte of the key; the first byte of plaintext will be XOR‚Äôd against I, the next C, the next E, then I again for the 4th byte, and so on.\n Implementing repeating-key XOR is similar to implementing single character XOR. However, with repeating-key XOR, we will cycle through each character of the key and XOR it again the each character in the message.\nFor example, repeating-key XOR for the first few letters in the message looks like this:\nB u r n 01000010 01110101 01010010 01101110 ---------------------------------------- I C E I 01001001 01000011 01000101 01001001 ---------------------------------------- XOR Result 00001011 00110110 00110111 00100111 ---------------------------------------- XOR Result 0b 36 37 27 in Hex The XOR result in hex are the first few characters of the expected result from the challenge description:\n 0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f\n Solution in Go package main import ( \"fmt\" \"github.com/julieqiu/cryptopals/set1\" ) const ( key = \"ICE\" input = `Burning 'em, if you ain't quick and nimble I go crazy when I hear a cymbal` ) func main() { b := repeatingXOR(input, key) // set1.BytesToHex was implemented in set 1 challenge 2. out := set1.BytesToHex(b) fmt.Println(out) } // repeatingXOR returns the XOR combination of the input and key using // repeating-key XOR. func repeatingXOR(input, key string) []byte { out := make([]byte, len(input)) for i := 0; i Output üéâ: 0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f\nTry it out in the Go playground.\n","wordCount":"392","inLanguage":"en","datePublished":"2022-02-24T00:00:00Z","dateModified":"2022-02-24T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://julieqiu.dev/writing/cryptopals-set1-challenge5/"},"publisher":{"@type":"Organization","name":"Julie Qiu","logo":{"@type":"ImageObject","url":"https://julieqiu.dev/writing/%3Clink%20/%20abs%20url%3E"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add('dark')</script>
<nav class=Nav-backgroundDark>
<div class=Nav-left>
<div class=Nav-title>
<a href=/>
Julie Qiu
</a>
</div>
<div class=Nav-social>
<div>
<a href=https://twitter.com/JQiu25 target=_blank><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
<small class=Nav-social-item>
Twitter
</small>
</a>
</div>
<div>
<a href=https://github.com/julieqiu target=_blank><svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
<small class=Nav-social-item>
GitHub
</small>
</a>
</div>
<div>
<a href=https://www.linkedin.com/in/julieyeqiu/ target=_blank><svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
<small class=Nav-social-item>
Linkedin
</small>
</a>
</div>
<div>
<a href=/contact><svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
<small class=Nav-social-item>
Contact
</small>
</a>
</div>
</div>
</div>
<div class=Nav-right>
<div class=Nav-menu-item>
<a href=/speaking>
Speaking
</a>
</div>
<div class=Nav-menu-item>
<a href=/writing>
Writing
</a>
</div>
<div class=Nav-menu-item>
<a href=/about>
About
</a>
</div>
</div>
</nav>
<section class=Writing-section>
<div class=Writing-container>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://julieqiu.dev/writing>Posts</a></div>
<h1 class=post-title>
Cryptopals - Set 1 Challenge 5: Implement repeating-key XOR
</h1>
<div class=post-meta><span title="2022-02-24 00:00:00 +0000 UTC">February 24, 2022</span>&nbsp;|&nbsp;<a href=https://github.com/julieqiu/julieqiu.github.io/blob/main/words/cryptopals-set1-challenge5.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header>
<div class=post-content><h2 id=implement-repeating-key-xor>Implement repeating-key XOR<a hidden class=anchor aria-hidden=true href=#implement-repeating-key-xor>#</a></h2>
<p>From <a href=https://cryptopals.com/sets/1/challenges/5>https://cryptopals.com/sets/1/challenges/5</a>:</p>
<blockquote>
<p>Here is the opening stanza of an important work of the English language:</p>
<p>Burning &lsquo;em, if you ain&rsquo;t quick and nimble
I go crazy when I hear a cymbal
Encrypt it, under the key &ldquo;ICE&rdquo;, using repeating-key XOR.</p>
<p>In repeating-key XOR, you&rsquo;ll sequentially apply each byte of the key; the first
byte of plaintext will be XOR&rsquo;d against I, the next C, the next E, then I again
for the 4th byte, and so on.</p>
<p>It should come out to:</p>
<p><code>0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f</code></p>
<p>Encrypt a bunch of stuff using your repeating-key XOR function. Encrypt your
mail. Encrypt your password file. Your .sig file. Get a feel for it. I promise,
we aren&rsquo;t wasting your time with this.</p>
</blockquote>
<h2 id=repeating-key-xor>Repeating-key XOR<a hidden class=anchor aria-hidden=true href=#repeating-key-xor>#</a></h2>
<p>A description of how to perform repeating XOR is provided in the description:</p>
<blockquote>
<p>In repeating-key XOR, you&rsquo;ll sequentially apply each byte of the key; the first
byte of plaintext will be XOR&rsquo;d against I, the next C, the next E, then I again
for the 4th byte, and so on.</p>
</blockquote>
<p>Implementing repeating-key XOR is similar to implementing <a href=/writing/cryptopals-set1-challenge4>single character
XOR</a>. However, with repeating-key XOR, we
will cycle through each character of the key and XOR it again the each
character in the message.</p>
<p>For example, repeating-key XOR for the first few letters in the message looks
like this:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>                  B          u         r        n
               01000010  01110101  01010010  01101110
               ----------------------------------------
                  I          C         E        I
               01001001  01000011  01000101  01001001
               ----------------------------------------

XOR Result     00001011  00110110  00110111  00100111

               ----------------------------------------

XOR Result        0b        36        37       27
in Hex

</code></pre></div><p>The XOR result in hex are the first few characters of the expected result from
the challenge description:</p>
<blockquote>
<p><code>0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f</code></p>
</blockquote>
<h3 id=solution-in-go>Solution in Go<a hidden class=anchor aria-hidden=true href=#solution-in-go>#</a></h3>
<pre tabindex=0><code>package main

import (
	&quot;fmt&quot;

	&quot;github.com/julieqiu/cryptopals/set1&quot;
)

const (
	key = &quot;ICE&quot;

	input = `Burning 'em, if you ain't quick and nimble
I go crazy when I hear a cymbal`
)

func main() {
	b := repeatingXOR(input, key)

	// set1.BytesToHex was implemented in set 1 challenge 2.
	out := set1.BytesToHex(b)
	fmt.Println(out)
}

// repeatingXOR returns the XOR combination of the input and key using
// repeating-key XOR.
func repeatingXOR(input, key string) []byte {
	out := make([]byte, len(input))
	for i := 0; i &lt; len(input); i++ {
		j := i % len(key) // sequentially apply each by the key
		out[i] = byte(key[j]) ^ byte(input[i])
	}
	return out
}
</code></pre><p>Output üéâ: <code>0b3637272a2b2e63622c2e69692a23693a2a3c6324202d623d63343c2a26226324272765272a282b2f20430a652e2c652a3124333a653e2b2027630c692b20283165286326302e27282f</code></p>
<p><a href=https://go.dev/play/p/91R1dqA3t7d>Try it out in the Go playground</a>.</p>
</div>
<div class=post-footer>
</div>
</article>
</div>
</section>
<footer>
<div>
¬© Julie Qiu
</div>
<div>
<a href=https://twitter.com/JQiu25 target=_blank><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
<small class=Footer-social-item>
Twitter
</small>
</a>
<a href=https://github.com/julieqiu target=_blank><svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
<small class=Footer-social-item>
GitHub
</small>
</a>
<a href=https://www.linkedin.com/in/julieyeqiu/ target=_blank><svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
<small class=Footer-social-item>
Linkedin
</small>
</a>
<a href=/contact><svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
<small class=Nav-social-item>
Contact
</small>
</a>
</div>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>